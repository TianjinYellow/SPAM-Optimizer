2024-12-25 21:16:06.980 | INFO     | __main__:main:217 - Using dist with rank 0 (only rank 0 will log)
2024-12-25 21:16:06.981 | INFO     | __main__:main:218 - ****************************************
2024-12-25 21:16:06.981 | INFO     | __main__:main:219 - Starting training with the arguments
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - model_config                   configs/llama_60m.json
model_config                   configs/llama_60m.json
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - use_hf_model                   False
use_hf_model                   False
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - continue_from                  None
continue_from                  None
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - batch_size                     128
batch_size                     128
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - gradient_accumulation          4
gradient_accumulation          4
2024-12-25 21:16:06.981 | INFO     | __main__:main:221 - total_batch_size               512
total_batch_size               512
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - max_length                     256
max_length                     256
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - optimizer                      SPAM
optimizer                      SPAM
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - lr                             0.004
lr                             0.004
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - scheduler                      cosine
scheduler                      cosine
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - min_lr_ratio                   0.1
min_lr_ratio                   0.1
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - activation_checkpointing       False
activation_checkpointing       False
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - weight_decay                   0.0
weight_decay                   0.0
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - warmup_steps                   1000
warmup_steps                   1000
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - eval_every                     1000
eval_every                     1000
2024-12-25 21:16:06.982 | INFO     | __main__:main:221 - num_training_steps             20000
num_training_steps             20000
2024-12-25 21:16:06.983 | INFO     | __main__:main:221 - max_train_tokens               None
max_train_tokens               None
2024-12-25 21:16:06.983 | INFO     | __main__:main:221 - save_every                     2000
save_every                     2000
2024-12-25 21:16:06.983 | INFO     | __main__:main:221 - save_dir                       /scratch-shared/HTJ2/checkpoints/new0_9152327
save_dir                       /scratch-shared/HTJ2/checkpoints/new0_9152327
2024-12-25 21:16:06.983 | INFO     | __main__:main:221 - tags                           None
tags                           None
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - dtype                          bfloat16
dtype                          bfloat16
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - workers                        8
workers                        8
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - seed                           0
seed                           0
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - name                           test
name                           test
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - model_type                     llama
model_type                     llama
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - grad_clipping                  0.0
grad_clipping                  0.0
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - beta1                          0.0
beta1                          0.0
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - rank                           0.3225388601036269
rank                           0.3225388601036269
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - update_proj_gap                500
update_proj_gap                500
2024-12-25 21:16:06.984 | INFO     | __main__:main:221 - galore_scale                   1.0
galore_scale                   1.0
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - updating_mask_method           interaction
updating_mask_method           interaction
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - init_mask                      random
init_mask                      random
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - single_gpu                     False
single_gpu                     False
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - mask_grad                      False
mask_grad                      False
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - spike_clip                     True
spike_clip                     True
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - sampling                       False
sampling                       False
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - load_local                     False
load_local                     False
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - m_replace                      False
m_replace                      False
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - warmup_epoch                   150
warmup_epoch                   150
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - threshold                      5000.0
threshold                      5000.0
2024-12-25 21:16:06.985 | INFO     | __main__:main:221 - grad_accu_steps                20.0
grad_accu_steps                20.0
2024-12-25 21:16:06.985 | INFO     | __main__:main:223 - ****************************************
2024-12-25 21:16:16.690 | INFO     | __main__:main:236 - Shuffling data with seed 42
/home/huangti/miniconda3/envs/spam/lib/python3.11/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
wandb: WARNING Saving files without folders. If you want to preserve subdirectories pass base_path to wandb.save, i.e. wandb.save("/mnt/folder/file.h5", base_path="/mnt")
Update steps:   0%|                                   | 0/20000 [00:00<?, ?it/s]2024-12-25 21:16:18.162 | INFO     | __main__:main:356 -
LlamaForCausalLM(
  (model): LlamaModel(
    (embed_tokens): Embedding(32000, 512, padding_idx=31999)
    (layers): ModuleList(
      (0-7): 8 x LlamaDecoderLayer(
        (self_attn): LlamaAttention(
          (q_proj): Linear(in_features=512, out_features=512, bias=False)
          (k_proj): Linear(in_features=512, out_features=512, bias=False)
          (v_proj): Linear(in_features=512, out_features=512, bias=False)
          (o_proj): Linear(in_features=512, out_features=512, bias=False)
          (rotary_emb): LlamaRotaryEmbedding()
        )
        (mlp): LlamaMLP(
          (gate_proj): Linear(in_features=512, out_features=1376, bias=False)
          (down_proj): Linear(in_features=1376, out_features=512, bias=False)
          (up_proj): Linear(in_features=512, out_features=1376, bias=False)
          (act_fn): SiLUActivation()
        )
        (input_layernorm): LlamaRMSNorm()
        (post_attention_layernorm): LlamaRMSNorm()
      )
    )
    (norm): LlamaRMSNorm()
  )
  (lm_head): Linear(in_features=512, out_features=32000, bias=False)
)

2024-12-25 21:16:18.162 | INFO     | __main__:main:357 - Total params: 58.07M
2024-12-25 21:16:18.162 | INFO     | __main__:main:358 - Trainable params: 58.07M
2024-12-25 21:16:18.162 | INFO     | __main__:main:361 - Saving model to /scratch-shared/HTJ2/checkpoints/new0_9152327 every 2000 update steps
/gpfs/home2/huangti/SPAM_v2/galore_torch/SPAM.py:68: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
density 0.3225375951262953
/home/huangti/miniconda3/envs/spam/lib/python3.11/site-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at /opt/conda/conda-bld/pytorch_1728945379270/work/aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass

loss at 4 2.625
Update steps:   2%|▌                      | 499/20000 [02:56<1:50:44,  2.94it/s]

loss at 404 1.796875

loss at 804 1.5546875

loss at 1204 1.375

loss at 1604 1.265625
lr 0.001992
lr 0.001992
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
  warnings.warn(
/home/huangti/miniconda3/envs/spam/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:240: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)

loss at 2004 1.203125
Update steps:   5%|█▏                     | 999/20000 [05:47<1:47:52,  2.94it/s]

loss at 2404 1.3203125

loss at 2804 1.1484375

loss at 3204 1.109375

loss at 3604 1.1015625
lr 0.003992
lr 0.003992
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:22:13.310 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 7.43 seconds
2024-12-25 21:22:13.312 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 7.43 seconds
2024-12-25 21:22:47.227 | INFO     | __main__:main:576 - Eval loss at step 1000: 4.2537407875061035,tokens_seen: 99979486

loss at 4004 1.0625
Update steps:   7%|█▋                    | 1499/20000 [09:18<1:44:56,  2.94it/s]

loss at 4404 1.0625

loss at 4804 1.0546875

loss at 5204 1.0234375

loss at 5604 1.015625
lr 0.0039939011446085354
lr 0.0039939011446085354
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 6004 1.0078125

loss at 6404 1.0

loss at 6804 1.0

loss at 7204 1.015625

loss at 7604 0.9765625
lr 0.00397554822383021
lr 0.00397554822383021
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:28:34.666 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 6.46 seconds
2024-12-25 21:28:34.668 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 6.47 seconds
2024-12-25 21:29:07.341 | INFO     | __main__:main:576 - Eval loss at step 2000: 3.9279537200927734,tokens_seen: 199880081

loss at 8004 1.0
Update steps:  12%|██▋                   | 2499/20000 [15:38<1:39:17,  2.94it/s]

loss at 8404 1.0

loss at 8804 0.9921875

loss at 9204 0.9921875

loss at 9604 0.95703125
lr 0.003945066508300911
lr 0.003945066508300911
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 10004 0.98046875

loss at 10404 0.9375

loss at 10804 0.953125

loss at 11204 0.9609375

loss at 11604 0.9375
lr 0.0039026642190457565
lr 0.0039026642190457565
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:34:52.584 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.56 seconds
2024-12-25 21:34:52.585 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.56 seconds
2024-12-25 21:35:24.644 | INFO     | __main__:main:576 - Eval loss at step 3000: 3.792433023452759,tokens_seen: 299903185

loss at 12004 0.94140625
Update steps:  17%|███▊                  | 3499/20000 [21:58<1:33:40,  2.94it/s]

loss at 12404 0.9453125

loss at 12804 0.93359375

loss at 13204 0.9453125

loss at 13604 0.94140625
lr 0.0038486310066957134
lr 0.0038486310066957134
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 14004 0.91796875

loss at 14404 0.94921875

loss at 14804 0.9296875

loss at 15204 0.9296875

loss at 15604 0.9375
lr 0.003783335972880091
lr 0.003783335972880091
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:41:10.987 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.37 seconds
2024-12-25 21:41:10.989 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.37 seconds
2024-12-25 21:41:43.053 | INFO     | __main__:main:576 - Eval loss at step 4000: 3.7090868949890137,tokens_seen: 399934286

loss at 16004 0.9453125
Update steps:  22%|████▉                 | 4499/20000 [28:15<1:28:18,  2.93it/s]

loss at 16404 0.9296875

loss at 16804 0.94921875

loss at 17204 0.92578125

loss at 17604 0.921875
lr 0.003707225148888141
lr 0.003707225148888141
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 18004 0.90234375

loss at 18404 0.90625

loss at 18804 0.93359375

loss at 19204 0.92578125

loss at 19604 0.9296875
lr 0.003620818448823091
lr 0.003620818448823091
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:47:28.953 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.36 seconds
2024-12-25 21:47:28.955 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.36 seconds
2024-12-25 21:48:00.882 | INFO     | __main__:main:576 - Eval loss at step 5000: 3.6500935554504395,tokens_seen: 499986358

loss at 20004 0.921875
Update steps:  27%|██████                | 5499/20000 [34:32<1:22:34,  2.93it/s]

loss at 20404 0.8828125

loss at 20804 0.92578125

loss at 21204 0.921875

loss at 21604 0.9140625
lr 0.0035247061180616254
lr 0.0035247061180616254
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 22004 0.9296875

loss at 22404 0.921875

loss at 22804 0.92578125

loss at 23204 0.91015625

loss at 23604 0.90625
lr 0.0034195447012794664
lr 0.0034195447012794664
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 21:53:49.950 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.48 seconds
2024-12-25 21:53:49.951 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.49 seconds
2024-12-25 21:54:22.139 | INFO     | __main__:main:576 - Eval loss at step 6000: 3.6067254543304443,tokens_seen: 600040686

loss at 24004 0.92578125
Update steps:  32%|███████▏              | 6499/20000 [40:53<1:16:40,  2.93it/s]

loss at 24404 0.91796875

loss at 24804 0.91796875

loss at 25204 0.9453125

loss at 25604 0.90625
lr 0.00330605255758551
lr 0.00330605255758551
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 26004 0.921875

loss at 26404 0.87890625

loss at 26804 0.91796875

loss at 27204 0.9140625

loss at 27604 0.87109375
lr 0.003185004953400705
lr 0.003185004953400705
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.33
Mask Update
2024-12-25 22:00:07.240 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.37 seconds
2024-12-25 22:00:07.241 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.37 seconds
2024-12-25 22:00:39.308 | INFO     | __main__:main:576 - Eval loss at step 7000: 3.5692410469055176,tokens_seen: 700029429

loss at 28004 0.91015625
Update steps:  37%|████████▏             | 7499/20000 [47:10<1:11:00,  2.93it/s]

loss at 28404 0.8984375

loss at 28804 0.9140625

loss at 29204 0.875

loss at 29604 0.875
lr 0.0030572287666022903
lr 0.0030572287666022903
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 30004 0.8671875

loss at 30404 0.9140625

loss at 30804 0.90234375

loss at 31204 0.90625

loss at 31604 0.88671875
lr 0.002923596838109448
lr 0.002923596838109448
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:06:26.265 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.60 seconds
2024-12-25 22:06:26.267 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.60 seconds
2024-12-25 22:06:58.217 | INFO     | __main__:main:576 - Eval loss at step 8000: 3.540757656097412,tokens_seen: 800038852

loss at 32004 0.87109375
Update steps:  42%|█████████▎            | 8499/20000 [53:30<1:05:36,  2.92it/s]

loss at 32404 0.90625

loss at 32804 0.90625

loss at 33204 0.89453125

loss at 33604 0.890625
lr 0.002785022009494777
lr 0.002785022009494777
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 34004 0.87109375

loss at 34404 0.90234375

loss at 34804 0.890625

loss at 35204 0.8515625

loss at 35604 0.8984375
lr 0.0026424508873507425
lr 0.0026424508873507425
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:12:43.623 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.35 seconds
2024-12-25 22:12:43.624 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.35 seconds
2024-12-25 22:13:15.830 | INFO     | __main__:main:576 - Eval loss at step 9000: 3.513287305831909,tokens_seen: 899981426

loss at 36004 0.859375
Update steps:  47%|███████████▍            | 9499/20000 [59:48<59:53,  2.92it/s]

loss at 36404 0.890625

loss at 36804 0.8984375

loss at 37204 0.8671875

loss at 37604 0.8671875
lr 0.0024968573770068054
lr 0.0024968573770068054
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 38004 0.875

loss at 38404 0.87890625

loss at 38804 0.84765625

loss at 39204 0.87890625

loss at 39604 0.8828125
lr 0.0023492360297684917
lr 0.0023492360297684917
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:19:02.338 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.00 seconds
2024-12-25 22:19:02.339 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.00 seconds
2024-12-25 22:19:34.100 | INFO     | __main__:main:576 - Eval loss at step 10000: 3.490687370300293,tokens_seen: 999938455

loss at 40004 0.8828125
Update steps:  52%|███████████          | 10499/20000 [1:06:06<54:10,  2.92it/s]

loss at 40404 0.87890625

loss at 40804 0.89453125

loss at 41204 0.8671875

loss at 41604 0.875
lr 0.002200595249123515
lr 0.002200595249123515
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 42004 0.87109375

loss at 42404 0.859375

loss at 42804 0.86328125

loss at 43204 0.8515625

loss at 43604 0.8828125
lr 0.002051950402323451
lr 0.002051950402323451
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:25:20.321 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.18 seconds
2024-12-25 22:25:20.322 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.18 seconds
2024-12-25 22:25:52.598 | INFO     | __main__:main:576 - Eval loss at step 11000: 3.469841241836548,tokens_seen: 1099986729

loss at 44004 0.86328125
Update steps:  57%|████████████         | 11499/20000 [1:12:24<48:26,  2.92it/s]

loss at 44404 0.8515625

loss at 44804 0.875

loss at 45204 0.875

loss at 45604 0.890625
lr 0.0019043168843958344
lr 0.0019043168843958344
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 46004 0.8984375

loss at 46404 0.875

loss at 46804 0.87890625

loss at 47204 0.8515625

loss at 47604 0.875
lr 0.0017587031819665288
lr 0.0017587031819665288
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:31:39.170 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.41 seconds
2024-12-25 22:31:39.171 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.41 seconds
2024-12-25 22:32:11.871 | INFO     | __main__:main:576 - Eval loss at step 12000: 3.4518392086029053,tokens_seen: 1199964331

loss at 48004 0.84765625
Update steps:  62%|█████████████        | 12499/20000 [1:18:44<42:40,  2.93it/s]

loss at 48404 0.87890625

loss at 48804 0.8671875

loss at 49204 0.859375

loss at 49604 0.87890625
lr 0.0016161039842734785
lr 0.0016161039842734785
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 50004 0.8828125

loss at 50404 0.8515625

loss at 50804 0.84765625

loss at 51204 0.875

loss at 51604 0.8359375
lr 0.0014774933884306122
lr 0.0014774933884306122
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:37:57.731 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.92 seconds
2024-12-25 22:37:57.732 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.92 seconds
2024-12-25 22:38:30.439 | INFO     | __main__:main:576 - Eval loss at step 13000: 3.436915636062622,tokens_seen: 1300025548

loss at 52004 0.8359375
Update steps:  67%|██████████████▏      | 13499/20000 [1:25:02<37:02,  2.93it/s]

loss at 52404 0.86328125

loss at 52804 0.859375

loss at 53204 0.87890625

loss at 53604 0.8515625
lr 0.0013438182453568302
lr 0.0013438182453568302
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 54004 0.8515625

loss at 54404 0.8515625

loss at 54804 0.85546875

loss at 55204 0.859375

loss at 55604 0.87109375
lr 0.0012159916918241392
lr 0.0012159916918241392
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:44:16.282 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.59 seconds
2024-12-25 22:44:16.284 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.60 seconds
2024-12-25 22:44:48.818 | INFO     | __main__:main:576 - Eval loss at step 14000: 3.42323899269104,tokens_seen: 1400046797

loss at 56004 0.8359375
Update steps:  72%|███████████████▏     | 14499/20000 [1:31:21<31:21,  2.92it/s]

loss at 56404 0.8359375

loss at 56804 0.875

loss at 57204 0.8671875

loss at 57604 0.87109375
lr 0.0010948869128075875
lr 0.0010948869128075875
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 58004 0.8828125

loss at 58404 0.8359375

loss at 58804 0.8359375

loss at 59204 0.8359375

loss at 59604 0.8359375
lr 0.0009813311767464888
lr 0.0009813311767464888
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:50:34.926 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.98 seconds
2024-12-25 22:50:34.928 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.98 seconds
2024-12-25 22:51:07.210 | INFO     | __main__:main:576 - Eval loss at step 15000: 3.411978006362915,tokens_seen: 1500063597

loss at 60004 0.84375
Update steps:  77%|████████████████▎    | 15499/20000 [1:37:39<25:38,  2.93it/s]

loss at 60404 0.84765625

loss at 60804 0.859375

loss at 61204 0.875

loss at 61604 0.875
lr 0.0008761001844621411
lr 0.0008761001844621411
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 62004 0.88671875

loss at 62404 0.85546875

loss at 62804 0.85546875

loss at 63204 0.85546875

loss at 63604 0.859375
lr 0.0007799127703346695
lr 0.0007799127703346695
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 22:56:53.470 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.79 seconds
2024-12-25 22:56:53.471 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.79 seconds
2024-12-25 22:57:25.718 | INFO     | __main__:main:576 - Eval loss at step 16000: 3.4030940532684326,tokens_seen: 1600154706

loss at 64004 0.86328125
Update steps:  82%|█████████████████▎   | 16499/20000 [1:43:58<19:57,  2.92it/s]

loss at 64404 0.8515625

loss at 64804 0.8515625

loss at 65204 0.86328125

loss at 65604 0.8671875
lr 0.0006934259919353199
lr 0.0006934259919353199
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 66004 0.8359375

loss at 66404 0.85546875

loss at 66804 0.84765625

loss at 67204 0.83984375

loss at 67604 0.828125
lr 0.0006172306416569991
lr 0.0006172306416569991
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 23:03:12.011 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.23 seconds
2024-12-25 23:03:12.013 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.23 seconds
2024-12-25 23:03:44.228 | INFO     | __main__:main:576 - Eval loss at step 17000: 3.3967816829681396,tokens_seen: 1700164802

loss at 68004 0.85546875
Update steps:  87%|██████████████████▎  | 17499/20000 [1:50:16<14:14,  2.93it/s]

loss at 68404 0.859375

loss at 68804 0.83984375

loss at 69204 0.8359375

loss at 69604 0.84765625
lr 0.0005518472110031761
lr 0.0005518472110031761
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 70004 0.859375

loss at 70404 0.85546875

loss at 70804 0.8671875

loss at 71204 0.83984375

loss at 71604 0.87109375
lr 0.0004977223351031438
lr 0.0004977223351031438
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 23:09:31.167 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 4.53 seconds
2024-12-25 23:09:31.168 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 4.53 seconds
2024-12-25 23:10:03.170 | INFO     | __main__:main:576 - Eval loss at step 18000: 3.392378568649292,tokens_seen: 1800161308

loss at 72004 0.8671875
Update steps:  92%|███████████████████▍ | 18499/20000 [1:56:35<08:33,  2.92it/s]

loss at 72404 0.87109375

loss at 72804 0.87109375

loss at 73204 0.84375

loss at 73604 0.8359375
lr 0.0004552257417412016
lr 0.0004552257417412016
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 74004 0.84765625

loss at 74404 0.84375

loss at 74804 0.8359375

loss at 75204 0.87109375

loss at 75604 0.84765625
lr 0.00042464772574098993
lr 0.00042464772574098993
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 23:15:49.001 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.90 seconds
2024-12-25 23:15:49.002 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.90 seconds
2024-12-25 23:16:21.439 | INFO     | __main__:main:576 - Eval loss at step 19000: 3.388871669769287,tokens_seen: 1900163851

loss at 76004 0.86328125
Update steps:  97%|████████████████████▍| 19499/20000 [2:02:54<02:51,  2.92it/s]

loss at 76404 0.859375

loss at 76804 0.8671875

loss at 77204 0.87109375

loss at 77604 0.88671875
lr 0.00040619716595749077
lr 0.00040619716595749077
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update

loss at 78004 0.82421875

loss at 78404 0.83984375

loss at 78804 0.8359375

loss at 79204 0.85546875

loss at 79604 0.83984375
lr 0.00040000009842264684
lr 0.00040000009842264684
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
density tensor(0.3225, device='cuda:0')
Mask overlap ratio: 0.32
Mask Update
2024-12-25 23:22:09.521 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 3.80 seconds
2024-12-25 23:22:09.522 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 3.80 seconds
2024-12-25 23:22:41.632 | INFO     | __main__:main:576 - Eval loss at step 20000: 3.386845588684082,tokens_seen: 2000123948

loss at 80004 0.83984375
Update steps: 20001it [2:06:23, 11.28s/it]                                      2024-12-25 23:22:41.967 | INFO     | __main__:main:493 - Reached max number of update steps (f20000). Stopping training.
Rank 0 stopping training.
2024-12-25 23:22:42.330 | INFO     | __main__:main:603 - Training finished
Update steps: 20001it [2:06:24,  2.64it/s]
2024-12-25 23:22:42.331 | INFO     | __main__:main:608 - Saving model and optimizer to /scratch-shared/HTJ2/checkpoints/new0_9152327/model_20001, update step 20001
2024-12-25 23:22:42.616 | INFO     | __main__:main:635 - Running final evaluation
2024-12-25 23:22:48.501 | INFO     | __main__:evaluate_model:113 - Loaded validation dataset in 5.73 seconds
2024-12-25 23:22:48.502 | INFO     | __main__:evaluate_model:129 - Eval set prepared in 5.73 seconds
2024-12-25 23:23:20.709 | INFO     | __main__:main:653 - Final eval loss: 3.386845588684082
2024-12-25 23:23:20.709 | INFO     | __main__:main:655 - Script finished successfully
Rank 0 finished successfully
perplexity 29.572521092484532
